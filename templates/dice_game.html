<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>éª°å­æ¸¸æˆ</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">
  <div class="container py-5 text-center">
    <h1 class="mb-4">ğŸ² éª°å­å¯¹æˆ˜æ¸¸æˆ</h1>

    <div id="result" class="alert alert-secondary" style="display: none;"></div>

    <button id="playBtn" class="btn btn-primary btn-lg">å¼€å§‹æ¸¸æˆ</button>

    <!-- âœ… æ·»åŠ ç»‘å®š Telegram æŒ‰é’® -->
    <div class="mt-4">
      <a href="https://t.me/mingameh5_bot?start={{ telegram_id }}" target="_blank" class="btn btn-primary">
  ğŸ“± ç‚¹å‡»ç»‘å®š Telegram è´¦å·
      </a>
    </div>
  </div>

  <script>
    const btn = document.getElementById("playBtn");
    const result = document.getElementById("result");

    btn.onclick = async () => {
      result.style.display = "none";
      const url = new URL(window.location.href);
      const user_id = url.searchParams.get("user_id");
      if (!user_id) return alert("âŒ ç¼ºå°‘ user_id");

      btn.disabled = true;
      btn.innerText = "æ¸¸æˆä¸­â€¦";

      const res = await fetch(`/api/play_game?user_id=${user_id}`);
      const data = await res.json();

      btn.disabled = false;
      btn.innerText = "å¼€å§‹æ¸¸æˆ";

      if (data.error) {
        result.className = "alert alert-danger";
        result.innerText = data.error;
      } else {
        result.className = "alert alert-success";
        result.innerText = `${data.message} ğŸ¯ å½“å‰ç§¯åˆ†ï¼š${data.total_points}`;
      }

      result.style.display = "block";
    };
  </script>
</body>
</html>
